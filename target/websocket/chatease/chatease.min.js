chatease=function(){if(chatease.api)return chatease.api.getInstance.apply(this,arguments)};chatease.version="0.1.13";chatease.debug=!1;
(function(d){function f(a){return null!==navigator.userAgent.toLowerCase().match(a)}var e=d.utils={};e.exists=function(a){switch(e.typeOf(a)){case "string":return 0<a.length;case "object":return null!==a;case "null":return!1}return!0};e.extend=function(){var a=Array.prototype.slice.call(arguments,0),c=a[0];if(1<a.length)for(var g=1;g<a.length;g++)e.foreach(a[g],function(a,g){void 0!==g&&null!==g&&(c[a]=g)});return c};e.foreach=function(a,c){for(var g in a)a.hasOwnProperty&&"function"===e.typeOf(a.hasOwnProperty)?
a.hasOwnProperty(g)&&c(g,a[g]):c(g,a[g])};e.getCookie=function(a){var c;return(c=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)")))?unescape(c[2]):null};e.createElement=function(a,c){var g=document.createElement(a);c&&(g.className=c);return g};e.addClass=function(a,c){var g="string"===e.typeOf(a.className)?a.className.split(" "):[],b="array"===e.typeOf(c)?c:c.split(" ");e.foreach(b,function(a,c){-1===e.indexOf(g,c)&&g.push(c)});a.className=e.trim(g.join(" "))};e.removeClass=function(a,
c){var g="string"===e.typeOf(a.className)?a.className.split(" "):[],b="array"===e.typeOf(c)?c:c.split(" ");e.foreach(b,function(a,c){var b=e.indexOf(g,c);0<=b&&g.splice(b,1)});a.className=e.trim(g.join(" "))};e.emptyElement=function(a){for(;a.firstChild;)a.removeChild(a.firstChild)};e.typeOf=function(a){if(null===a||void 0===a)return"null";var c=typeof a;if("object"===c)try{if("[object Array]"===toString.call(a))return"array"}catch(g){}return c};e.trim=function(a){return a.replace(/^\s+|\s+$/g,"")};
e.indexOf=function(a,c){if(null==a)return-1;for(var g=0;g<a.length;g++)if(a[g]===c)return g;return-1};e.isMSIE=function(a){return a?(a=parseFloat(a).toFixed(1),f(new RegExp("msie\\s*"+a,"i"))):f(/msie/i)};var b=window.console=window.console||{log:function(){}};e.log=function(){var a=Array.prototype.slice.call(arguments,0);"object"===e.typeOf(b.log)?b.log(a):b.log.apply(b,a)}})(chatease);
(function(d){function f(){var a=document.createElement("style");a.type="text/css";document.getElementsByTagName("head")[0].appendChild(a);return a.sheet||a.styleSheet}var e=d.utils,b;(e.css=function(a,c){b||(b=f());var g="";e.foreach(c,function(a,c){g+=a+": "+c+"; "});try{b.insertRule?b.insertRule(a+" { "+g+"}",b.cssRules.length):b.addRule(a,g,b.rules.length)}catch(d){e.log("Failed to insert css rule: "+a)}}).style=function(a,c,g){if(void 0!==a&&null!==a)for(void 0===a.length&&(a=[a]),c=e.extend({},
c),g=0;g<a.length;g++){var b=a[g];void 0!==b&&null!==b&&e.foreach(c,function(a,g){var c;c=a.split("-");for(var e=1;e<c.length;e++)c[e]=c[e].charAt(0).toUpperCase()+c[e].slice(1);c=c.join("");b.style[c]!==g&&(b.style[c]=g)})}}})(chatease);(function(d){var f=d.utils;f.filter=function(e){var b,a="";this.replace=function(c){return a&&b?c.replace(b,"**"):c};"string"==f.typeOf(e)&&e&&(a=e,b=new RegExp(a,"ig"))}})(chatease);
(function(d){d.events={ERROR:"ERROR",CHATEASE_READY:"chateaseReady",CHATEASE_SETUP_ERROR:"chateaseSetupError",CHATEASE_RENDER_ERROR:"chateaseRenderError",CHATEASE_STATE:"chateaseState",CHATEASE_CONNECT:"chateaseConnect",CHATEASE_INDENT:"chateaseIdent",CHATEASE_MESSAGE:"chateaseMessage",CHATEASE_JOIN:"chateaseJoin",CHATEASE_LEFT:"chateaseLeft",CHATEASE_ERROR:"chateaseError",CHATEASE_CLOSE:"chateaseClose",CHATEASE_VIEW_SEND:"chateaseViewSend",CHATEASE_VIEW_SHIELDMSG:"chateaseViewMsgShield",CHATEASE_VIEW_CLEARSCREEN:"chateaseViewClearScreen",
CHATEASE_VIEW_NICKCLICK:"chateaseViewNickClick"}})(chatease);
(function(d){var f=d.utils;d.events.eventdispatcher=function(e){function b(a,c,e){if(a)for(var b=0;b<a.length;b++){var d=a[b];if(d){null!==d.count&&0===--d.count&&delete a[b];try{d.listener(c)}catch(u){f.log('Error handling "'+e+'" event listener ['+b+"]: "+u.toString(),d.listener,c)}}}}var a={},c=[];this.addEventListener=function(c,b,e){try{f.exists(a[c])||(a[c]=[]),"string"===f.typeOf(b)&&(b=(new Function("return "+b))()),a[c].push({listener:b,count:e||null})}catch(d){f.log("error",d)}return!1};
this.removeEventListener=function(c,b){if(a[c]){try{if(void 0===b){a[c]=[];return}var e;for(e=0;e<a[c].length;e++)if(a[c][e].listener.toString()===b.toString()){a[c].splice(e,1);break}}catch(d){f.log("error",d)}return!1}};this.addGlobalListener=function(a,b){try{"string"===f.typeOf(a)&&(a=(new Function("return "+a))()),c.push({listener:a,count:b||null})}catch(e){f.log("error",e)}return!1};this.removeGlobalListener=function(a){if(a){try{var b;for(b=c.length-1;0<=b;b--)c[b].listener.toString()===a.toString()&&
c.splice(b,1)}catch(e){f.log("error",e)}return!1}};this.dispatchEvent=function(g,h){h||(h={});f.extend(h,{id:e,version:d.version,type:g});d.debug&&f.log(g,h);b(a[g],h,g);b(c,h,g)}}})(chatease);
(function(d){var f=d.utils,e=d.events,b={},a={onError:e.ERROR,onReady:e.CHATEASE_READY,onConnect:e.CHATEASE_CONNECT,onIdent:e.CHATEASE_INDENT,onMessage:e.CHATEASE_MESSAGE,onJoin:e.CHATEASE_JOIN,onLeft:e.CHATEASE_LEFT,onNickClick:e.CHATEASE_VIEW_NICKCLICK,onClose:e.CHATEASE_CLOSE};d.api=function(c){function b(a){h.dispatchEvent(a.type,a)}var h=f.extend(this,new e.eventdispatcher("api")),t;h.container=c;h.id=c.id;h.setup=function(a){f.emptyElement(h.container);h.config=a;h.config.id=h.id;h.embedder=
new d.embed(h);h.embedder.addGlobalListener(b);h.embedder.embed();return h};h.setEntity=function(a,c){t=a;h.renderName=c;h.send=t.send;h.resize=t.resize};(function(){f.foreach(a,function(a,c){h[a]=function(a){h.addEventListener(c,a)}})})()};d.api.getInstance=function(a){var e;null==a?a=0:a.nodeType?e=a:"string"===f.typeOf(a)&&(e=document.getElementById(a));if(e){var h=b[e.id];h||(b[a]=h=new d.api(e));return h}return"number"===f.typeOf(a)?b[a]:null};d.api.displayError=function(a,b){}})(chatease);
(function(d){d.core={}})(chatease);(function(d){d.core.states={CONNECTED:"connected",CLOSED:"closed",ERROR:"error"}})(chatease);(function(d){d.core.renders={}})(chatease);(function(d){d.core.renders.modes={DEFAULT:"def"}})(chatease);(function(d){d.core.renders.skins={}})(chatease);(function(d){d.core.renders.skins.modes={DEFAULT:"def"}})(chatease);
(function(d){var f=d.utils,e=d.events,b=f.css;d.core.renders.skins.def=function(a){var c=f.extend(this,new e.eventdispatcher("skins.def"));b(".chatwrap",{width:a.width+"px",height:a.height+"px","box-shadow":"0 1px 1px rgba(0, 0, 0, 0.05)"});b(".chatwrap *",{margin:"0",padding:"0","font-family":"\u5fae\u8f6f\u96c5\u9ed1,arial,sans-serif","font-size":"14px","font-weight":"normal","box-sizing":"content-box"});b(".render",{width:a.width-2+"px",height:a.height-2+"px",border:"1px solid #1184ce","border-radius":"4px",
position:"relative"});b(" .title",{padding:"auto 12px",width:"100%",height:"34px","font-family":"inherit","font-weight":"normal",color:"#fff","text-align":"center","line-height":"34px","vertical-align":"middle","box-shadow":"none","background-color":"#1184ce",cursor:"not-allowed","pointer-events":"none"});b(" .title span",{top:"2px","margin-left":"2px"});b(" .main",{width:"100%",height:a.height-2-parseInt("34px")+"px"});b(" .main .console",{width:"100%",height:.75*(a.height-parseInt("34px"))+"px",
"max-height":"75%","overflow-y":"auto","background-color":"#f8f8f8"});b(" .main .console > div",{margin:"5px","word-break":"break-all","word-wrap":"break-word"});b(" .main .console > div > span",{"margin-right":"5px"});b(" .main .console > div > span.vip1",{});b(" .main .console > div > span.vip2",{});b(" .main .console > div > span.vip3",{});b(" .main .console > div > span.vip4",{});b(" .main .console > div > span.vip5",{});b(" .main .console > div > span.vip6",{});b(" .main .console > div > span.vip7",
{});b(" .main .console > div > span.temporary",{});b(" .main .console > div > span.manager",{});b(" .main .console > div > span.owner",{});b(" .main .console > div > span.system",{});b(" .main .console > div > span.admin",{});b(" .main .console > div > a",{"margin-right":"5px",color:"#1184ce","text-decoration":"none",cursor:"pointer"});b(" .main .console > div.system > a",{"font-style":"normal","font-weight":"bold",color:"red"});b(" .main .console > div.myself",{});b(" .main .console > div.myself > a",
{});b(" .main .dialog",{width:"100%",height:.25*(a.height-1-parseInt("34px"))+"px",position:"relative",overflow:"hidden"});b(" .main .dialog .control",{width:"100%",height:"38px",border:"1px solid #1184ce","border-width":"1px 0"});b(" .main .dialog .control > *",{margin:"0 5px",height:"100%","line-height":"38px","text-align":"center","vertical-align":"middle","box-sizing":"border-box",display:"inline-block"});b(" .main .dialog .control > div > .ch",{color:"#666","vertical-align":"middle",cursor:"pointer"});
b(" .main .dialog .control > div > .ch input[type=checkbox]",{"margin-right":"5px",cursor:"pointer"});b(" .main .dialog .control > div > .ch a",{});b(" .main .dialog .control > div > .btn",{padding:"3px 5px",color:"#fff","text-align":"center","vertical-align":"middle","border-radius":"3px","background-color":"#1184ce",cursor:"pointer"});b(" .main .dialog .control .msgshield",{"float":"left"});b(" .main .dialog .control .clrscreen",{"float":"right"});b(" .main .dialog .control .clrscreen span",{top:"2px",
"margin-left":"2px"});b(" .main .dialog .input",{position:"relative"});b(" .main .dialog .input textarea",{"float":"left",margin:"0",padding:"5px 10px",width:a.width-2-parseInt("46px")+"px",height:.25*(a.height-parseInt("34px"))-parseInt("38px")-2+"px",resize:"none",border:"0 none","border-radius":"0 0 0 4px","box-sizing":"border-box",overflow:"auto"});b(" .main .dialog .input button",{"float":"left",padding:0,width:"46px",height:.25*(a.height-parseInt("34px"))-parseInt("38px")-2+"px",color:"#fff",
border:"0 none","box-sizing":"border-box","background-color":"#1184ce",cursor:"pointer"});f.isMSIE(7)&&(b(" .main .dialog .input textarea",{width:a.width-2-parseInt("46px")-20+"px",height:.25*(a.height-parseInt("34px"))-parseInt("38px")-12+"px"}),b(" .main .dialog .input button",{height:.25*(a.height-parseInt("34px"))-parseInt("38px")+"px"}));c.resize=function(c,e){f.log("Resizing to "+c+", "+e);a.width=parseInt(c);a.height=parseInt(e);var d=document.getElementById(a.id),x=document.getElementById(a.prefix+
"render"),k=document.getElementById(a.prefix+"main"),u=document.getElementById(a.prefix+"console"),l=document.getElementById(a.prefix+"dialog"),q=document.getElementById(a.prefix+"input"),m=document.getElementById(a.prefix+"submit");b.style(d,{width:a.width+"px",height:a.height+"px"});b.style(x,{width:a.width-2+"px",height:a.height-2+"px"});b.style(k,{height:a.height-2-parseInt("34px")+"px"});b.style(u,{height:.75*(a.height-parseInt("34px"))+"px"});b.style(l,{height:.25*(a.height-1-parseInt("34px"))+
"px"});b.style(q,{width:a.width-2-parseInt("46px")+"px",height:.25*(a.height-parseInt("34px"))-parseInt("38px")-2+"px"});b.style(m,{height:.25*(a.height-parseInt("34px"))-parseInt("38px")-2+"px"});f.isMSIE(7)&&(b.style(q,{width:a.width-2-parseInt("46px")-20+"px",height:.25*(a.height-parseInt("34px"))-parseInt("38px")-12+"px"}),b.style(m,{height:.25*(a.height-parseInt("34px"))-parseInt("38px")+"px"}))}}})(chatease);
(function(d){var f=d.utils,e=d.events;d=d.core.renders;var b=d.skins,a=b.modes;d.def=function(c,g){function d(a){var c="";switch(f.typeOf(a)){case "string":if(a=parseInt(a),NaN==a||0>a)break;case "number":a&128?c="admin":a&64||(a&32?c="owner":a&16?c="manager":a&8&&(c="temporary")),a&7&&(c+=(c.length?" ":"")+"vip"+(a&7))}return c}function t(a){a=window.event||a;13==a.keyCode&&(a.ctrlKey?n.value+="\r\n":(k.send(),window.event?window.event.returnValue=!1:a.preventDefault()))}function x(a){k.send()}var k=
f.extend(this,new e.eventdispatcher("renders.def")),u={skin:{name:a.DEFAULT},prefix:"chat-"},l,q,m,r,w,p,n,v;k.show=function(a,b){var n=f.createElement("div"),g;switch(f.typeOf(a)){case "object":g=a.text;if("uni"==a.pipe.type){var v=f.createElement("span");v.innerHTML="[\u5bc6\u8bed]";n.appendChild(v)}break;default:g=a}switch(f.typeOf(b)){case "string":if(""===b)break;b={id:0,name:b,role:0};case "null":b={id:0,name:"[\u7cfb\u7edf]",role:64};case "object":if(null==f.typeOf(b.id))break;if(v=0<=b.role&&
b.role&64?"system":b.id==c.user().id?"myself":"")n.className=v;if(v=d(b.role)){var l=f.createElement("span",v);l.innerHTML=v.substr(0,1);n.appendChild(l)}v=f.createElement("a");v.user=f.extend({},b);v.innerHTML=b.name;try{v.addEventListener("click",function(a){k.dispatchEvent(e.CHATEASE_VIEW_NICKCLICK,{user:this.user})})}catch(t){v.attachEvent("onclick",function(a){k.dispatchEvent(e.CHATEASE_VIEW_NICKCLICK,{user:this.user})})}n.appendChild(v)}n.insertAdjacentHTML("beforeend",g);m.childNodes.length>=
k.config.maxRecords&&m.removeChild(m.childNodes[0]);m.appendChild(n);m.scrollTop=m.scrollHeight};k.send=function(){k.dispatchEvent(e.CHATEASE_VIEW_SEND,{data:{text:n.value,type:"multi",pipe:k.config.channel}});k.clearInput()};k.clearInput=function(){n.value=""};k.clearScreen=function(){f.emptyElement(m)};k.element=function(){return l};k.resize=function(a,b){a=a||l.offsetWidth||g.width;b=b||l.offsetHeight||g.height;v&&v.resize(a,b)};k.destroy=function(){};k.config=f.extend({},u,g);l=f.createElement("div",
"render");q=f.createElement("div","title");u=f.createElement("div","main");l.appendChild(q);l.appendChild(u);m=f.createElement("div","console");r=f.createElement("div","dialog");u.appendChild(m);u.appendChild(r);w=f.createElement("div","control");p=f.createElement("div","input");r.appendChild(w);r.appendChild(p);q.innerHTML="\u804a\u5929\u5ba4";(function(a,b,c,e,n){a=f.createElement("div",a);var g=f.createElement("label","ch"),d=f.createElement("input");d.type="checkbox";d.checked=!!n;try{d.addEventListener("change",
function(a){k.dispatchEvent(b,f.extend({shield:d.checked},c))})}catch(v){d.attachEvent("onchange",function(a){k.dispatchEvent(b,f.extend({shield:d.checked},c))})}g.appendChild(d);n=f.createElement("a");n.innerHTML=e;g.appendChild(n);a.appendChild(g);w.appendChild(a)})("msgshield",e.CHATEASE_VIEW_SHIELDMSG,null,"\u5c4f\u853d\u6d88\u606f",!1);(function(a,b,c,e,n){a=f.createElement("div",a);n=f.createElement("a","btn");n.innerHTML=e;try{n.addEventListener("click",function(a){k.dispatchEvent(b,c)})}catch(d){n.attachEvent("onclick",
function(a){k.dispatchEvent(b,c)})}a.appendChild(n);w.appendChild(a)})("clrscreen",e.CHATEASE_VIEW_CLEARSCREEN,null,"\u6e05\u5c4f","glyphicon glyphicon-trash");n=f.createElement("textarea");n.setAttribute("placeholder","\u8f93\u5165\u804a\u5929\u5185\u5bb9");k.config.maxlength&&n.setAttribute("maxlength",k.config.maxlength);try{n.addEventListener("keypress",t)}catch(y){n.attachEvent("onkeypress",t)}p.appendChild(n);q=f.createElement("button");q.innerHTML="\u53d1\u9001";try{q.addEventListener("click",
x)}catch(y){q.attachEvent("onclick",x)}p.appendChild(q);l.id=k.config.prefix+"render";u.id=k.config.prefix+"main";m.id=k.config.prefix+"console";r.id=k.config.prefix+"dialog";n.id=k.config.prefix+"input";q.id=k.config.prefix+"submit";try{v=new b[k.config.skin.name](k.config)}catch(y){f.log("Failed to init skin["+k.config.skin.name+"].")}v||k.dispatchEvent(e.CHATEASE_RENDER_ERROR,{message:"No suitable skin found!",skin:k.config.skin.name})}})(chatease);
(function(d){var f=d.utils,e=d.events,b=d.core;b.entity=function(a){var c=f.extend(this,new e.eventdispatcher("core.entity")),d,h,t;c.setup=function(){h.setup()};c.destroy=function(){t&&t.stop();h&&h.destroy();d&&d.destroy()};c.id=a.id;c.model=d=new b.model(a);c.view=h=new b.view(c,d);c.controller=t=new b.controller(d,h);t.addGlobalListener(function(a){c.dispatchEvent(a.type,a)});c.send=t.send;c.resize=h.resize}})(chatease);
(function(d){var f=d.utils,e=d.events;d=d.core;var b=d.states;d.model=function(a){var c=f.extend(this,new e.eventdispatcher("core.model"));c.setState=function(a){a!==c.state&&(c.state=a,c.dispatchEvent(e.CHATEASE_STATE,{state:a}))};c.setMsgShield=function(a){a!==c.shieldMsg&&(c.shieldMsg=a,c.dispatchEvent(e.CHATEASE_VIEW_SHIELDMSG,{shield:a}))};c.getConfig=function(a){return c.config[a]||{}};c.destroy=function(){};c.config=f.extend({},{},a);f.extend(c,{id:a.id,user:{id:NaN,name:"",role:-1},state:b.CLOSED,
shieldMsg:!1},c.config)}})(chatease);
(function(d){var f=d.utils,e=d.events;d=d.core;var b=d.renders,a=b.modes;d.view=function(c,d){function h(){switch(d.render.name){case a.DEFAULT:var c=f.extend(d.getConfig("render"),{id:d.id,width:d.width,height:d.height,channel:d.channel,maxlength:d.maxlength,maxRecords:d.maxRecords});r.render=p=new b[a.DEFAULT](r,c);break;default:r.dispatchEvent(e.CHATEASE_SETUP_ERROR,{message:"Unknown render mode!",render:d.render.name})}p&&(p.addEventListener(e.CHATEASE_VIEW_SEND,t),p.addEventListener(e.CHATEASE_VIEW_SHIELDMSG,
x),p.addEventListener(e.CHATEASE_VIEW_CLEARSCREEN,k),p.addEventListener(e.CHATEASE_VIEW_NICKCLICK,u),p.addEventListener(e.CHATEASE_RENDER_ERROR,l),w.appendChild(p.element()))}function t(a){q(a)}function x(a){q(a)}function k(a){q(a)}function u(a){q(a)}function l(a){q(a)}function q(a){r.dispatchEvent(a.type,a)}function m(a){if(a.ctrlKey||a.metaKey)return!0;switch(a.keyCode){case 13:p.send()}if(/13/.test(a.keyCode))return a.preventDefault?a.preventDefault():a.returnValue=!1,!1}var r=f.extend(this,new e.eventdispatcher("core.view")),
w,p;r.setup=function(){h();try{w.addEventListener("keydown",m)}catch(a){w.attachEvent("onkeydown",m)}setTimeout(function(){r.dispatchEvent(e.CHATEASE_READY,{channelId:c.id})},0)};r.show=function(a,b){d.shieldMsg||p&&p.show(a,b)};r.user=function(){return d.user};r.resize=function(a,b){p&&p.resize(a,b)};r.destroy=function(){w&&w.removeEventListener("keydown",m);p&&p.destroy()};(function(){w=f.createElement("div","chatwrap");w.id=c.id;w.tabIndex=0;var a=document.getElementById(c.id);a.parentNode.replaceChild(w,
a);window.onresize=function(){"function"==f.typeOf(d.onresize)?d.onresize.call(null):r.resize()}})()}})(chatease);
(function(d){var f=d.utils,e=d.events;d=d.core;var b=d.states;d.controller=function(a,c){function d(){if(!m){var c=f.getCookie("token"),c=c?(-1==a.url.indexOf("?")?"?":"&")+"token="+c:"";try{m=window.WebSocket?new WebSocket(a.url+c):window.MozWebSocket?new MozWebSocket(a.url+c):new SockJS(a.url.replace(/^ws/,"http")+"/sockjs")}catch(e){f.log("Failed to initialize websocket.");return}m.onopen=function(c){a.setState(b.CONNECTED)};m.onmessage=h;m.onerror=function(c){a.setState(b.ERROR)};m.onclose=function(c){a.setState(b.CLOSED)}}}
function h(b){var d;try{d=eval("("+b.data+")")}catch(g){f.log("Eval failed. \nerr: "+g+"\ndata: "+b.data);return}switch(d.raw){case "ident":f.foreach(d.user,function(b,c){a.user.hasOwnProperty(b)&&(a.user[b]=c)});a.interval=d.user.interval;c.show("\u52a0\u5165\u623f\u95f4\u6210\u529f\uff01");l.dispatchEvent(e.CHATEASE_INDENT,d);break;case "message":try{r||(r=new f.filter(a.keywords)),d.text=r.replace(d.text)}catch(g){f.log("Failed to execute filter.")}c.show(d,d.user);l.dispatchEvent(e.CHATEASE_MESSAGE,
d);break;case "join":c.show(x(d.user.role)+" "+d.user.name+" \u8fdb\u5165\u804a\u5929\u5ba4\u3002");l.dispatchEvent(e.CHATEASE_JOIN,d);break;case "left":c.show(x(d.user.role)+" "+d.user.name+" \u5df2\u79bb\u5f00\u3002");l.dispatchEvent(e.CHATEASE_LEFT,d);break;case "error":(b=t(d))&&c.show(b);l.dispatchEvent(e.CHATEASE_ERROR,d);break;default:f.log("Unknown data type, ignored.")}}function t(a){var b;switch(a.error.code){case 400:b="\u9519\u8bef\u8bf7\u6c42\uff01";break;case 401:b="\u8bf7\u5148\u767b\u5f55\uff01";
break;case 403:b="\u6743\u9650\u9519\u8bef\uff01";break;case 404:b="\u672a\u77e5\u8bf7\u6c42\uff01";break;case 409:b="\u64cd\u4f5c\u9891\u7e41\uff01"}return b}function x(a){var b="";switch(f.typeOf(a)){case "string":if(a=parseInt(a),NaN==a||0>a)break;case "number":a&192?b="\u8d85\u7ba1":a&32?b="\u4e3b\u64ad":a&24?b="\u623f\u7ba1":a&7&&(b="VIP"+(a&7))}return b}function k(){if(!a.maxRetries||p<a.maxRetries){var b=Math.ceil(a.retryDelay+5E3*Math.random());c.show("\u6b63\u5728\u51c6\u5907\u91cd\u8fde\uff0c"+
b/1E3+"\u79d2...");setTimeout(function(){p++;m=null;d()},b)}}function u(a){l.dispatchEvent(a.type,a)}var l=f.extend(this,new e.eventdispatcher("core.controller")),q=!1,m,r,w=0,p=0;l.send=function(e){if(m&&a.state!=b.CLOSED){var f=(new Date).getTime();0<=a.interval&&f-w<a.interval?c.show("\u64cd\u4f5c\u9891\u7e41\uff01"):(w=f,m.send(JSON.stringify(e)))}else d()};l.join=function(a){l.send({cmd:"join",channel:{id:a}})};l.close=function(){m&&m.close()};a.addEventListener(e.CHATEASE_STATE,function(d){switch(d.state){case b.CONNECTED:c.show("\u804a\u5929\u5ba4\u5df2\u8fde\u63a5\u2026");
p=0;l.dispatchEvent(e.CHATEASE_CONNECT);l.join(a.channel);break;case b.CLOSED:c.show("\u804a\u5929\u5ba4\u8fde\u63a5\u5df2\u65ad\u5f00\uff01");l.dispatchEvent(e.CHATEASE_CLOSE,{channel:{id:a.channel}});k();break;case b.ERROR:c.show("\u804a\u5929\u5ba4\u5f02\u5e38\uff01");l.dispatchEvent(e.CHATEASE_ERROR,{message:"Chat room error!",channel:{id:a.channel}});break;default:l.dispatchEvent(e.CHATEASE_ERROR,{message:"Unknown model state!",state:d.state})}});a.addEventListener(e.CHATEASE_VIEW_SHIELDMSG,
function(a){u(a)});c.addEventListener(e.CHATEASE_READY,function(c){q||(u(c),q=!0,d(),window.onbeforeunload=function(c){m&&a.state==b.CONNECTED&&m.close()})});c.addEventListener(e.CHATEASE_VIEW_SEND,function(b){b.data.text=f.trim(a.maxlength?b.data.text.substr(0,a.maxlength):b.data.text);b.data.text?l.send({cmd:"message",text:b.data.text,pipe:{type:b.data.type,id:b.data.pipe}}):c.show("\u8bf7\u8f93\u5165\u5185\u5bb9\uff01")});c.addEventListener(e.CHATEASE_VIEW_SHIELDMSG,function(b){a.setMsgShield(b.shield)});
c.addEventListener(e.CHATEASE_VIEW_CLEARSCREEN,function(a){c.render.clearScreen();u(a)});c.addEventListener(e.CHATEASE_VIEW_NICKCLICK,function(a){u(a)});c.addEventListener(e.CHATEASE_SETUP_ERROR,function(a){u(a)});c.addEventListener(e.CHATEASE_RENDER_ERROR,function(a){u(a)})}})(chatease);
(function(d){var f=d.utils,e=d.events,b=d.embed=function(a){function c(a){switch(a.type){case e.ERROR:case e.CHATEASE_SETUP_ERROR:case e.CHATEASE_RENDER_ERROR:case e.CHATEASE_ERROR:g.errorScreen(a.message);g.dispatchEvent(e.ERROR,a);break;default:g.dispatchEvent(a.type,a)}}var g=f.extend(this,new e.eventdispatcher("embed")),h={},t=!1,x=null;g.embed=function(){try{h=new b.config(a.config),x=new b.embedder(a,h)}catch(d){f.log("Failed to init embedder!");g.dispatchEvent(e.CHATEASE_SETUP_ERROR,{message:"Failed to init embedder!",
render:h.render.name,fallback:h.fallback});return}x.addGlobalListener(c);x.embed()};g.errorScreen=function(a){t||(t=!0,d.api.displayError(a,h))};(function(){f.foreach(h.events,function(b,c){var d=a[b];"function"===f.typeOf(d)&&d.call(a,c)})})()}})(chatease);
(function(d){var f=d.utils,e=d.embed,b=d.core.renders.modes,a=d.core.renders.skins.modes;e.config=function(c){return f.extend({},{url:"ws://"+window.location.host+"/websocket/websck",width:300,height:450,channel:1,maxlength:30,interval:0,maxRetries:0,retryDelay:3E3,render:{name:b.DEFAULT,skin:{name:a.DEFAULT}},keywords:"",maxRecords:50},c)};e.config.addConfig=function(a,b){return f.extend(a,b)}})(chatease);
(function(d){var f=d.utils,e=d.events,b=d.core;d.embed.embedder=function(a,c){function d(a){h.dispatchEvent(a.type,a)}var h=f.extend(this,new e.eventdispatcher("embed.embedder"));h.embed=function(){var e=new b.entity(c);e.addGlobalListener(d);e.setup();a.setEntity(e,c.render.name)}}})(chatease);