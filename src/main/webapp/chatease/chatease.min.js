chatease=function(){if(chatease.api)return chatease.api.getInstance.apply(this,arguments)};chatease.version="0.1.10";chatease.debug=!1;
(function(d){function f(a){return null!==navigator.userAgent.toLowerCase().match(a)}var e=d.utils={};e.exists=function(a){switch(e.typeOf(a)){case "string":return 0<a.length;case "object":return null!==a;case "null":return!1}return!0};e.extend=function(){var a=Array.prototype.slice.call(arguments,0),c=a[0];if(1<a.length)for(var g=1;g<a.length;g++)e.foreach(a[g],function(a,g){void 0!==g&&null!==g&&(c[a]=g)});return c};e.foreach=function(a,c){for(var g in a)a.hasOwnProperty&&"function"===e.typeOf(a.hasOwnProperty)?
a.hasOwnProperty(g)&&c(g,a[g]):c(g,a[g])};e.getCookie=function(a){var c;return(c=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)")))?unescape(c[2]):null};e.createElement=function(a,c){var g=document.createElement(a);c&&(g.className=c);return g};e.addClass=function(a,c){var g="string"===e.typeOf(a.className)?a.className.split(" "):[],b="array"===e.typeOf(c)?c:c.split(" ");e.foreach(b,function(a,c){-1===e.indexOf(g,c)&&g.push(c)});a.className=e.trim(g.join(" "))};e.removeClass=function(a,
c){var g="string"===e.typeOf(a.className)?a.className.split(" "):[],b="array"===e.typeOf(c)?c:c.split(" ");e.foreach(b,function(a,c){var b=e.indexOf(g,c);0<=b&&g.splice(b,1)});a.className=e.trim(g.join(" "))};e.emptyElement=function(a){for(;a.firstChild;)a.removeChild(a.firstChild)};e.typeOf=function(a){if(null===a||void 0===a)return"null";var c=typeof a;if("object"===c)try{if("[object Array]"===toString.call(a))return"array"}catch(g){}return c};e.trim=function(a){return a.replace(/^\s+|\s+$/g,"")};
e.indexOf=function(a,c){if(null==a)return-1;for(var g=0;g<a.length;g++)if(a[g]===c)return g;return-1};e.isMSIE=function(a){return a?(a=parseFloat(a).toFixed(1),f(new RegExp("msie\\s*"+a,"i"))):f(/msie/i)};var b=window.console=window.console||{log:function(){}};e.log=function(){var a=Array.prototype.slice.call(arguments,0);"object"===e.typeOf(b.log)?b.log(a):b.log.apply(b,a)}})(chatease);
(function(d){function f(){var a=document.createElement("style");a.type="text/css";document.getElementsByTagName("head")[0].appendChild(a);return a.sheet||a.styleSheet}var e=d.utils,b;(e.css=function(a,c){b||(b=f());var g="";e.foreach(c,function(a,c){g+=a+": "+c+"; "});try{b.insertRule?b.insertRule(a+" { "+g+"}",b.cssRules.length):b.addRule(a,g,b.rules.length)}catch(d){e.log("Failed to insert css rule: "+a)}}).style=function(a,c,g){if(void 0!==a&&null!==a)for(void 0===a.length&&(a=[a]),c=e.extend({},
c),g=0;g<a.length;g++){var b=a[g];void 0!==b&&null!==b&&e.foreach(c,function(a,g){var c;c=a.split("-");for(var e=1;e<c.length;e++)c[e]=c[e].charAt(0).toUpperCase()+c[e].slice(1);c=c.join("");b.style[c]!==g&&(b.style[c]=g)})}}})(chatease);(function(d){var f=d.utils;f.filter=function(e){var b,a="";this.replace=function(c){return a&&b?c.replace(b,"**"):c};"string"==f.typeOf(e)&&e&&(a=e,b=new RegExp(a,"ig"))}})(chatease);
(function(d){d.events={ERROR:"ERROR",CHATEASE_READY:"chateaseReady",CHATEASE_SETUP_ERROR:"chateaseSetupError",CHATEASE_RENDER_ERROR:"chateaseRenderError",CHATEASE_STATE:"chateaseState",CHATEASE_CONNECT:"chateaseConnect",CHATEASE_INDENT:"chateaseIdent",CHATEASE_MESSAGE:"chateaseMessage",CHATEASE_JOIN:"chateaseJoin",CHATEASE_LEFT:"chateaseLeft",CHATEASE_ERROR:"chateaseError",CHATEASE_CLOSE:"chateaseClose",CHATEASE_VIEW_SEND:"chateaseViewSend",CHATEASE_VIEW_SHIELDMSG:"chateaseViewMsgShield",CHATEASE_VIEW_CLEARSCREEN:"chateaseViewClearScreen",
CHATEASE_VIEW_NICKCLICK:"chateaseViewNickClick"}})(chatease);
(function(d){var f=d.utils;d.events.eventdispatcher=function(e){function b(a,c,e){if(a)for(var b=0;b<a.length;b++){var d=a[b];if(d){null!==d.count&&0===--d.count&&delete a[b];try{d.listener(c)}catch(n){f.log('Error handling "'+e+'" event listener ['+b+"]: "+n.toString(),d.listener,c)}}}}var a={},c=[];this.addEventListener=function(c,b,e){try{f.exists(a[c])||(a[c]=[]),"string"===f.typeOf(b)&&(b=(new Function("return "+b))()),a[c].push({listener:b,count:e||null})}catch(d){f.log("error",d)}return!1};
this.removeEventListener=function(c,b){if(a[c]){try{if(void 0===b){a[c]=[];return}var e;for(e=0;e<a[c].length;e++)if(a[c][e].listener.toString()===b.toString()){a[c].splice(e,1);break}}catch(d){f.log("error",d)}return!1}};this.addGlobalListener=function(a,b){try{"string"===f.typeOf(a)&&(a=(new Function("return "+a))()),c.push({listener:a,count:b||null})}catch(e){f.log("error",e)}return!1};this.removeGlobalListener=function(a){if(a){try{var b;for(b=c.length-1;0<=b;b--)c[b].listener.toString()===a.toString()&&
c.splice(b,1)}catch(e){f.log("error",e)}return!1}};this.dispatchEvent=function(g,k){k||(k={});f.extend(k,{id:e,version:d.version,type:g});d.debug&&f.log(g,k);b(a[g],k,g);b(c,k,g)}}})(chatease);
(function(d){var f=d.utils,e=d.events,b={},a={onError:e.ERROR,onReady:e.CHATEASE_READY,onConnect:e.CHATEASE_CONNECT,onIdent:e.CHATEASE_INDENT,onMessage:e.CHATEASE_MESSAGE,onJoin:e.CHATEASE_JOIN,onLeft:e.CHATEASE_LEFT,onNickClick:e.CHATEASE_VIEW_NICKCLICK,onClose:e.CHATEASE_CLOSE};d.api=function(c){function b(a){k.dispatchEvent(a.type,a)}var k=f.extend(this,new e.eventdispatcher("api")),t;k.container=c;k.id=c.id;k.setup=function(a){f.emptyElement(k.container);k.config=a;k.embedder=new d.embed(k);k.embedder.addGlobalListener(b);
k.embedder.embed();return k};k.setEntity=function(a,c){t=a;k.renderName=c;k.send=t.send;k.resize=t.resize};(function(){f.foreach(a,function(a,c){k[a]=function(a){k.addEventListener(c,a)}})})()};d.api.getInstance=function(a){var e;null==a?a=0:a.nodeType?e=a:"string"===f.typeOf(a)&&(e=document.getElementById(a));if(e){var k=b[e.id];k||(b[a]=k=new d.api(e));return k}return"number"===f.typeOf(a)?b[a]:null};d.api.displayError=function(a,b){}})(chatease);(function(d){d.core={}})(chatease);
(function(d){d.core.states={CONNECTED:"connected",CLOSED:"closed",ERROR:"error"}})(chatease);(function(d){d.core.renders={}})(chatease);(function(d){d.core.renders.modes={DEFAULT:"def"}})(chatease);(function(d){d.core.renders.skins={}})(chatease);(function(d){d.core.renders.skins.modes={DEFAULT:"def"}})(chatease);
(function(d){var f=d.utils,e=d.events,b=f.css;d.core.renders.skins.def=function(a){var c=f.extend(this,new e.eventdispatcher("skins.def"));b(".chatwrap",{width:a.width+"px",height:a.height+"px","box-shadow":"0 1px 1px rgba(0, 0, 0, 0.05)"});b(".chatwrap *",{margin:"0",padding:"0","font-family":"\u5fae\u8f6f\u96c5\u9ed1,arial,sans-serif","font-size":"14px","font-weight":"normal","box-sizing":"content-box"});b(".render",{width:a.width-2+"px",height:a.height-2+"px",border:"1px solid #1184ce","border-radius":"4px",
position:"relative"});b(" .title",{padding:"auto 12px",width:"100%",height:"34px","font-family":"inherit","font-weight":"normal",color:"#fff","text-align":"center","line-height":"34px","vertical-align":"middle","box-shadow":"none","background-color":"#1184ce",cursor:"not-allowed","pointer-events":"none"});b(" .title span",{top:"2px","margin-left":"2px"});b(" .main",{width:"100%",height:a.height-2-parseInt("34px")+"px"});b(" .main .console",{width:"100%",height:.75*(a.height-parseInt("34px"))+"px",
"max-height":"75%","overflow-y":"auto","background-color":"#f8f8f8"});b(" .main .console > div",{margin:"5px","word-break":"break-all","word-wrap":"break-word"});b(" .main .console > div > span",{"margin-right":"5px"});b(" .main .console > div > span.vip1",{});b(" .main .console > div > span.vip2",{});b(" .main .console > div > span.vip3",{});b(" .main .console > div > span.vip4",{});b(" .main .console > div > span.vip5",{});b(" .main .console > div > span.vip6",{});b(" .main .console > div > span.vip7",
{});b(" .main .console > div > span.temporary",{});b(" .main .console > div > span.manager",{});b(" .main .console > div > span.owner",{});b(" .main .console > div > span.system",{});b(" .main .console > div > span.admin",{});b(" .main .console > div > a",{"margin-right":"5px",color:"#1184ce","text-decoration":"none",cursor:"pointer"});b(" .main .console > div.system > a",{"font-style":"normal","font-weight":"bold",color:"red"});b(" .main .console > div.myself",{});b(" .main .console > div.myself > a",
{});b(" .main .dialog",{width:"100%",height:.25*(a.height-1-parseInt("34px"))+"px",position:"relative",overflow:"hidden"});b(" .main .dialog .control",{width:"100%",height:"38px",border:"1px solid #1184ce","border-width":"1px 0"});b(" .main .dialog .control > *",{margin:"0 5px",height:"100%","line-height":"38px","text-align":"center","vertical-align":"middle","box-sizing":"border-box",display:"inline-block"});b(" .main .dialog .control > div > .ch",{color:"#666","vertical-align":"middle",cursor:"pointer"});
b(" .main .dialog .control > div > .ch input[type=checkbox]",{"margin-right":"5px",cursor:"pointer"});b(" .main .dialog .control > div > .ch a",{});b(" .main .dialog .control > div > .btn",{padding:"3px 5px",color:"#fff","text-align":"center","vertical-align":"middle","border-radius":"3px","background-color":"#1184ce",cursor:"pointer"});b(" .main .dialog .control .msgshield",{"float":"left"});b(" .main .dialog .control .clrscreen",{"float":"right"});b(" .main .dialog .control .clrscreen span",{top:"2px",
"margin-left":"2px"});b(" .main .dialog .input",{position:"relative"});b(" .main .dialog .input textarea",{"float":"left",margin:"0",padding:"5px 10px",width:a.width-2-parseInt("46px")+"px",height:.25*(a.height-parseInt("34px"))-parseInt("38px")-2+"px",resize:"none",border:"0 none","border-radius":"0 0 0 4px","box-sizing":"border-box",overflow:"auto"});b(" .main .dialog .input button",{"float":"left",padding:0,width:"46px",height:.25*(a.height-parseInt("34px"))-parseInt("38px")-2+"px",color:"#fff",
border:"0 none","box-sizing":"border-box","background-color":"#1184ce",cursor:"pointer"});f.isMSIE(7)&&(b(" .main .dialog .input textarea",{width:a.width-2-parseInt("46px")-20+"px",height:.25*(a.height-parseInt("34px"))-parseInt("38px")-12+"px"}),b(" .main .dialog .input button",{height:.25*(a.height-parseInt("34px"))-parseInt("38px")+"px"}));c.resize=function(c,e){f.log("Resizing to "+c+", "+e);a.width=parseInt(c);a.height=parseInt(e);var d=document.getElementById(a.id),w=document.getElementById(a.prefix+
"render"),h=document.getElementById(a.prefix+"main"),n=document.getElementById(a.prefix+"console"),v=document.getElementById(a.prefix+"dialog"),l=document.getElementById(a.prefix+"input"),q=document.getElementById(a.prefix+"submit");b.style(d,{width:a.width+"px",height:a.height+"px"});b.style(w,{width:a.width-2+"px",height:a.height-2+"px"});b.style(h,{height:a.height-2-parseInt("34px")+"px"});b.style(n,{height:.75*(a.height-parseInt("34px"))+"px"});b.style(v,{height:.25*(a.height-1-parseInt("34px"))+
"px"});b.style(l,{width:a.width-2-parseInt("46px")+"px",height:.25*(a.height-parseInt("34px"))-parseInt("38px")-2+"px"});b.style(q,{height:.25*(a.height-parseInt("34px"))-parseInt("38px")-2+"px"});f.isMSIE(7)&&(b.style(l,{width:a.width-2-parseInt("46px")-20+"px",height:.25*(a.height-parseInt("34px"))-parseInt("38px")-12+"px"}),b.style(q,{height:.25*(a.height-parseInt("34px"))-parseInt("38px")+"px"}))}}})(chatease);
(function(d){var f=d.utils,e=d.events;d=d.core.renders;var b=d.skins,a=b.modes;d.def=function(c,g){function d(a){var c="";switch(f.typeOf(a)){case "string":if(a=parseInt(a),NaN==a||0>a)break;case "number":a&128?c="admin":a&64||(a&32?c="owner":a&16?c="manager":a&8&&(c="temporary")),a&7&&(c+=(c.length?" ":"")+"vip"+(a&7))}return c}function t(a){a=window.event||a;13==a.keyCode&&(a.ctrlKey?m.value+="\r\n":(h.send(),window.event?window.event.returnValue=!1:a.preventDefault()))}function w(a){h.send()}var h=
f.extend(this,new e.eventdispatcher("renders.def")),n={skin:{name:a.DEFAULT},prefix:"chat-"},v,l,q,r,u,p,m,x;h.show=function(a,b){var g=f.createElement("div"),p;switch(f.typeOf(a)){case "object":p=a.text;if("uni"==a.type){var m=f.createElement("span");m.innerHTML="[\u5bc6\u8bed]";g.appendChild(m)}break;default:p=a}switch(f.typeOf(b)){case "string":if(""===b)break;b={id:0,name:b,role:0};case "null":b={id:0,name:"[\u7cfb\u7edf]",role:64};case "object":if(null==f.typeOf(b.id))break;if(m=0<=b.role&&b.role&
64?"system":b.id==c.user().id?"myself":"")g.className=m;if(m=d(b.role)){var l=f.createElement("span",m);l.innerHTML=m.substr(0,1);g.appendChild(l)}m=f.createElement("a");m.user=f.extend({},b);m.innerHTML=b.name;try{m.addEventListener("click",function(a){h.dispatchEvent(e.CHATEASE_VIEW_NICKCLICK,{user:this.user})})}catch(n){m.attachEvent("onclick",function(a){h.dispatchEvent(e.CHATEASE_VIEW_NICKCLICK,{user:this.user})})}g.appendChild(m)}g.insertAdjacentHTML("beforeend",p);q.childNodes.length>=h.config.maxRecords&&
q.removeChild(q.childNodes[0]);q.appendChild(g);q.scrollTop=q.scrollHeight};h.send=function(){h.dispatchEvent(e.CHATEASE_VIEW_SEND,{message:m.value,userId:null});h.clearInput()};h.clearInput=function(){m.value=""};h.clearScreen=function(){f.emptyElement(q)};h.element=function(){return v};h.resize=function(a,b){a=a||v.offsetWidth||g.width;b=b||v.offsetHeight||g.height;x&&x.resize(a,b)};h.destroy=function(){};h.config=f.extend({},n,g);v=f.createElement("div","render");l=f.createElement("div","title");
n=f.createElement("div","main");v.appendChild(l);v.appendChild(n);q=f.createElement("div","console");r=f.createElement("div","dialog");n.appendChild(q);n.appendChild(r);u=f.createElement("div","control");p=f.createElement("div","input");r.appendChild(u);r.appendChild(p);l.innerHTML="\u804a\u5929\u5ba4";(function(a,b,c,e,g){a=f.createElement("div",a);var d=f.createElement("label","ch"),m=f.createElement("input");m.type="checkbox";m.checked=!!g;try{m.addEventListener("change",function(a){h.dispatchEvent(b,
f.extend({shield:m.checked},c))})}catch(p){m.attachEvent("onchange",function(a){h.dispatchEvent(b,f.extend({shield:m.checked},c))})}d.appendChild(m);g=f.createElement("a");g.innerHTML=e;d.appendChild(g);a.appendChild(d);u.appendChild(a)})("msgshield",e.CHATEASE_VIEW_SHIELDMSG,null,"\u5c4f\u853d\u6d88\u606f",!1);(function(a,b,c,e,g){a=f.createElement("div",a);g=f.createElement("a","btn");g.innerHTML=e;try{g.addEventListener("click",function(a){h.dispatchEvent(b,c)})}catch(d){g.attachEvent("onclick",
function(a){h.dispatchEvent(b,c)})}a.appendChild(g);u.appendChild(a)})("clrscreen",e.CHATEASE_VIEW_CLEARSCREEN,null,"\u6e05\u5c4f","glyphicon glyphicon-trash");m=f.createElement("textarea");m.setAttribute("placeholder","\u8f93\u5165\u804a\u5929\u5185\u5bb9");h.config.maxlength&&m.setAttribute("maxlength",h.config.maxlength);try{m.addEventListener("keypress",t)}catch(y){m.attachEvent("onkeypress",t)}p.appendChild(m);l=f.createElement("button");l.innerHTML="\u53d1\u9001";try{l.addEventListener("click",
w)}catch(y){l.attachEvent("onclick",w)}p.appendChild(l);v.id=h.config.prefix+"render";n.id=h.config.prefix+"main";q.id=h.config.prefix+"console";r.id=h.config.prefix+"dialog";m.id=h.config.prefix+"input";l.id=h.config.prefix+"submit";try{x=new b[h.config.skin.name](h.config)}catch(y){f.log("Failed to init skin["+h.config.skin.name+"].")}x||h.dispatchEvent(e.CHATEASE_RENDER_ERROR,{message:"No suitable skin found!",skin:h.config.skin.name})}})(chatease);
(function(d){var f=d.utils,e=d.events,b=d.core;b.entity=function(a){var c=f.extend(this,new e.eventdispatcher("core.entity")),g,d,t;c.setup=function(){d.setup()};c.destroy=function(){t&&t.stop();d&&d.destroy();g&&g.destroy()};c.id=a.id;c.model=g=new b.model(a);c.view=d=new b.view(c,g);c.controller=t=new b.controller(g,d);t.addGlobalListener(function(a){c.dispatchEvent(a.type,a)});c.send=t.send;c.resize=d.resize}})(chatease);
(function(d){var f=d.utils,e=d.events;d=d.core;var b=d.states;d.model=function(a){var c=f.extend(this,new e.eventdispatcher("core.model"));c.setState=function(a){a!==c.state&&(c.state=a,c.dispatchEvent(e.CHATEASE_STATE,{state:a}))};c.setMsgShield=function(a){a!==c.shieldMsg&&(c.shieldMsg=a,c.dispatchEvent(e.CHATEASE_VIEW_SHIELDMSG,{shield:a}))};c.getConfig=function(a){return c.config[a]||{}};c.destroy=function(){};c.config=f.extend({},{},a);f.extend(c,{id:a.id,user:{id:NaN,name:"",role:-1},state:b.CLOSED,
shieldMsg:!1},c.config)}})(chatease);
(function(d){var f=d.utils,e=d.events;d=d.core;var b=d.renders,a=b.modes;d.view=function(c,d){function k(){switch(d.render.name){case a.DEFAULT:var c=f.extend(d.getConfig("render"),{id:d.id,width:d.width,height:d.height,maxlength:d.maxlength,maxRecords:d.maxRecords});r.render=p=new b[a.DEFAULT](r,c);break;default:r.dispatchEvent(e.CHATEASE_SETUP_ERROR,{message:"Unknown render mode!",render:d.render.name})}p&&(p.addEventListener(e.CHATEASE_VIEW_SEND,t),p.addEventListener(e.CHATEASE_VIEW_SHIELDMSG,w),
p.addEventListener(e.CHATEASE_VIEW_CLEARSCREEN,h),p.addEventListener(e.CHATEASE_VIEW_NICKCLICK,n),p.addEventListener(e.CHATEASE_RENDER_ERROR,v),u.appendChild(p.element()))}function t(a){l(a)}function w(a){l(a)}function h(a){l(a)}function n(a){l(a)}function v(a){l(a)}function l(a){r.dispatchEvent(a.type,a)}function q(a){if(a.ctrlKey||a.metaKey)return!0;switch(a.keyCode){case 13:p.send()}if(/13/.test(a.keyCode))return a.preventDefault?a.preventDefault():a.returnValue=!1,!1}var r=f.extend(this,new e.eventdispatcher("core.view")),
u,p;r.setup=function(){k();try{u.addEventListener("keydown",q)}catch(a){u.attachEvent("onkeydown",q)}setTimeout(function(){r.dispatchEvent(e.CHATEASE_READY,{channelId:c.id})},0)};r.show=function(a,b){d.shieldMsg||p&&p.show(a,b)};r.user=function(){return d.user};r.resize=function(a,b){p&&p.resize(a,b)};r.destroy=function(){u&&u.removeEventListener("keydown",q);p&&p.destroy()};(function(){u=f.createElement("div","chatwrap");u.id=c.id;u.tabIndex=0;var a=document.getElementById(c.id);a.parentNode.replaceChild(u,
a);window.onresize=function(){"function"==f.typeOf(d.onresize)?d.onresize.call(null):r.resize()}})()}})(chatease);
(function(d){var f=d.utils,e=d.events;d=d.core;var b=d.states;d.controller=function(a,c){function d(){if(!l){try{var g=f.getCookie("token"),h=g?(-1==a.url.indexOf("?")?"?":"&")+"token="+g:"";l=window.WebSocket?new WebSocket(a.url+h):window.MozWebSocket?new MozWebSocket(a.url+h):new SockJS(a.url.replace(/^ws/,"http")+"/sockjs")}catch(r){f.log("Failed to initialize websocket.");return}l.onopen=function(c){a.setState(b.CONNECTED)};l.onmessage=function(b){var d;try{d=eval("("+b.data+")")}catch(g){f.log("Eval failed. \nerr: "+
g+"\ndata: "+b.data);return}switch(d.raw){case "ident":f.foreach(d.user,function(b,c){a.user.hasOwnProperty(b)&&(a.user[b]=c)});a.interval=d.user.interval;n.dispatchEvent(e.CHATEASE_INDENT,d);break;case "message":try{q||(q=new f.filter(a.keywords)),d.data.text=q.replace(d.data.text)}catch(g){f.log("Failed to execute filter.")}c.show(d.data,d.user);n.dispatchEvent(e.CHATEASE_MESSAGE,d);break;case "join":c.show(t(d.user.role)+" "+d.user.name+" \u8fdb\u5165\u804a\u5929\u5ba4\u3002");n.dispatchEvent(e.CHATEASE_JOIN,
d);break;case "left":c.show(t(d.user.role)+" "+d.user.name+" \u5df2\u79bb\u5f00\u3002");n.dispatchEvent(e.CHATEASE_LEFT,d);break;case "error":(b=k(d))&&c.show(b);n.dispatchEvent(e.CHATEASE_ERROR,d);break;default:f.log("Unknown data type, ignored.")}};l.onerror=function(c){a.setState(b.ERROR)};l.onclose=function(c){a.setState(b.CLOSED)}}}function k(a){var b;switch(a.data.code){case 400:b="\u9519\u8bef\u8bf7\u6c42\uff01";break;case 401:b="\u8bf7\u5148\u767b\u5f55\uff01";break;case 403:b="\u6743\u9650\u9519\u8bef\uff01";
break;case 404:b="\u672a\u77e5\u8bf7\u6c42\uff01";break;case 409:b="\u64cd\u4f5c\u9891\u7e41\uff01"}return b}function t(a){var b="";switch(f.typeOf(a)){case "string":if(a=parseInt(a),NaN==a||0>a)break;case "number":a&192?b="\u8d85\u7ba1":a&32?b="\u4e3b\u64ad":a&24?b="\u623f\u7ba1":a&7&&(b="VIP"+(a&7))}return b}function w(){if(!a.maxRetries||u<a.maxRetries){var b=Math.ceil(a.retryDelay+5E3*Math.random());c.show("\u6b63\u5728\u51c6\u5907\u91cd\u8fde\uff0c"+b/1E3+"\u79d2...");setTimeout(function(){u++;
l=null;d()},b)}}function h(a){n.dispatchEvent(a.type,a)}var n=f.extend(this,new e.eventdispatcher("core.controller")),v=!1,l,q,r=0,u=0;n.send=function(c,e){l&&a.state!=b.CLOSED?l.send(c):d()};n.close=function(){l&&l.close()};a.addEventListener(e.CHATEASE_STATE,function(d){switch(d.state){case b.CONNECTED:c.show("\u804a\u5929\u5ba4\u5df2\u8fde\u63a5\u3002");u=0;n.dispatchEvent(e.CHATEASE_CONNECT,{channelId:a.id});break;case b.CLOSED:c.show("\u804a\u5929\u5ba4\u8fde\u63a5\u5df2\u65ad\u5f00\uff01");
n.dispatchEvent(e.CHATEASE_CLOSE,{channelId:a.id});w();break;case b.ERROR:c.show("\u804a\u5929\u5ba4\u5f02\u5e38\uff01");n.dispatchEvent(e.CHATEASE_ERROR,{message:"Chat room error!",channelId:a.id});break;default:n.dispatchEvent(e.CHATEASE_ERROR,{message:"Unknown model state!",state:d.state})}});a.addEventListener(e.CHATEASE_VIEW_SHIELDMSG,function(a){h(a)});c.addEventListener(e.CHATEASE_READY,function(c){v||(h(c),v=!0,d(),window.onbeforeunload=function(c){l&&a.state==b.CONNECTED&&l.close()})});c.addEventListener(e.CHATEASE_VIEW_SEND,
function(b){b.message=f.trim(a.maxlength?b.message.substr(0,a.maxlength):b.message);if(b.message){var d=(new Date).getTime();0<=a.interval&&d-r<a.interval?c.show("\u64cd\u4f5c\u9891\u7e41\uff01"):(r=d,n.send(b.message,b.userId))}else c.show("\u8bf7\u8f93\u5165\u5185\u5bb9\uff01")});c.addEventListener(e.CHATEASE_VIEW_SHIELDMSG,function(b){a.setMsgShield(b.shield)});c.addEventListener(e.CHATEASE_VIEW_CLEARSCREEN,function(a){c.render.clearScreen();h(a)});c.addEventListener(e.CHATEASE_VIEW_NICKCLICK,
function(a){h(a)});c.addEventListener(e.CHATEASE_SETUP_ERROR,function(a){h(a)});c.addEventListener(e.CHATEASE_RENDER_ERROR,function(a){h(a)})}})(chatease);
(function(d){var f=d.utils,e=d.events,b=d.embed=function(a){function c(a){switch(a.type){case e.ERROR:case e.CHATEASE_SETUP_ERROR:case e.CHATEASE_RENDER_ERROR:case e.CHATEASE_ERROR:g.errorScreen(a.message);g.dispatchEvent(e.ERROR,a);break;default:g.dispatchEvent(a.type,a)}}var g=f.extend(this,new e.eventdispatcher("embed")),k=new b.config(a.config),t=!1,w=null;k.id=a.id;g.embed=function(){try{w=new b.embedder(a,k)}catch(d){f.log("Failed to init embedder!");g.dispatchEvent(e.CHATEASE_SETUP_ERROR,{message:"Failed to init embedder!",
render:k.render.name,fallback:k.fallback});return}w.addGlobalListener(c);w.embed()};g.errorScreen=function(a){t||(t=!0,d.api.displayError(a,k))};(function(){f.foreach(k.events,function(b,c){var d=a[b];"function"===f.typeOf(d)&&d.call(a,c)})})()}})(chatease);
(function(d){var f=d.utils,e=d.embed,b=d.core.renders.modes,a=d.core.renders.skins.modes;e.config=function(c){return f.extend({},{url:"ws://"+window.location.host+"/websocket/websck",width:300,height:450,maxlength:30,interval:0,maxRetries:0,retryDelay:3E3,render:{name:b.DEFAULT,skin:{name:a.DEFAULT}},keywords:"",maxRecords:50},c)};e.config.addConfig=function(a,b){return f.extend(a,b)}})(chatease);
(function(d){var f=d.utils,e=d.events,b=d.core;d.embed.embedder=function(a,c){function d(a){k.dispatchEvent(a.type,a)}var k=f.extend(this,new e.eventdispatcher("embed.embedder"));k.embed=function(){var e=new b.entity(c);e.addGlobalListener(d);e.setup();a.setEntity(e,c.render.name)}}})(chatease);